# 下一阶段工作计划

**更新日期**: 2026-01-28  
**项目**: GreenPrj  
**基准状态**: Web 功能与测试、CI 已完成；Android 仅基建就绪

---

## 一、当前状态速览

| 维度 | 状态 |
|------|------|
| **Web 功能** | Epic 1–9 全部完成（认证、记账、统计、预算、合并、数据管理、操作日志、离线支持） |
| **Web 测试** | E2E 64 / 单元+组件 130 通过；测试计划与文档已就绪 |
| **CI/CD** | GitHub Actions：lint → vitest → **npm run build（tsc && vite）** → Playwright E2E |
| **代码质量** | ESLint、`tsc` 均通过；CI 使用完整构建 |
| **Android** | Epic 1 完成（初始化、Room）；Epic 2–9 功能未实现 |

---

## 二、阶段一：夯实质量与生产就绪（建议 1–2 周）

**目标**：TypeScript 与 CI 闭环，为部署和后续迭代打基础。

### 1.1 修复 TypeScript 严格检查（高） ✅

- [x] 修掉 `tsc` 报错（如 `notes`/`month` 的 `null` vs `undefined`、schema 断言、`NodeJS` 命名空间、`CreateEntryInput` 等）
- [x] CI 恢复 `npm run build`（`tsc && vite build`），替代原先仅 `vite build`
- **产出**：`tsc` 零报错，CI 与本地构建一致

### 1.2 构建与体积优化（中）

- [ ] 对路由或大依赖做 `manualChunks` / 动态 `import()`，缓解 chunk > 500KB 告警
- [ ] 视需要配置 `build.chunkSizeWarningLimit` 或拆包策略
- **产出**：首屏与懒加载更合理，构建告警可控

### 1.3 文档补充（中）

- [ ] **用户文档**：安装、首次使用、密码/备份/恢复、常见问题
- [ ] **部署文档**：构建、环境变量、静态托管（如 Vercel/Netlify/GitHub Pages）
- [ ] **开发者文档**：项目结构、脚本说明、测试与 CI、贡献约定（可复用 `web/tests/README.md`）
- **产出**：`docs/` 下用户向与开发向文档可交付

### 1.4 安全与配置（中）

- [ ] 确认无敏感信息硬编码；密钥/环境变量经构建注入
- [ ] 若有后端或敏感接口，补依赖扫描、安全审计
- **产出**：安全项清单与简单检查流程

---

## 三、阶段二：平台扩展与增强（建议 2–4 周）

**目标**：按优先级扩展 Android 或增强 Web。

### 2.1 Android 功能开发（高，若投入移动端）

- [ ] **Epic 2**：用户认证（密码设置、登录、修改、会话）
- [ ] **Epic 3**：核心记账（录入、列表、编辑、删除、搜索筛选）
- [ ] **Epic 4–9**：统计、预算、合并、数据管理、操作日志、离线等（与 Web 对齐）
- **产出**：Android 端可用的最小闭环，再逐步补齐能力

### 2.2 Web 功能增强（低–中，可选）

- [ ] 数据可视化增强（图表、维度、导出报表）
- [ ] 多语言支持（i18n）
- [ ] 主题切换（明/暗）
- **产出**：按需实现，计入产品 backlog

### 2.3 性能优化（中，可选）

- [ ] 大数据量统计计算优化（分页、缓存、worker）
- [ ] 操作日志查询与索引优化
- [ ] 列表/图表组件渲染优化（虚拟列表、按需渲染）
- **产出**：关键路径性能指标与优化记录

---

## 四、阶段三：部署与运营（建议 1 个月+）

**目标**：上线、反馈与持续改进。

### 3.1 部署与发布（高）

- [ ] 生产环境配置（域名、CDN、HTTPS）
- [ ] 自动化部署（如 GitHub Actions → Vercel/Netlify/自建）
- [ ] 简单发布检查清单（构建、烟雾测试、回滚）
- **产出**：可复现的部署流程与文档

### 3.2 监控与可观测性（中）

- [ ] 前端错误追踪（如 Sentry）
- [ ] 基础性能监控（LCP、FID、CLS 等）
- [ ] 日志与告警策略（若引入后端）
- **产出**：监控看板与告警规则

### 3.3 用户反馈与迭代（持续）

- [ ] Beta 测试与反馈收集
- [ ] 根据反馈调整优先级，更新本计划
- **产出**：反馈清单与迭代 backlog

---

## 五、建议执行顺序（汇总）

| 顺序 | 事项 | 优先级 | 预估 |
|------|------|--------|------|
| 1 | 修复 `tsc` 报错，CI 恢复 `npm run build` | 高 | 2–4 天 |
| 2 | 构建分包 / chunk 优化 | 中 | 1–2 天 |
| 3 | 用户 + 部署 + 开发者文档 | 中 | 2–3 天 |
| 4 | 安全与配置检查 | 中 | 0.5–1 天 |
| 5 | Android Epic 2–3 或 Web 增强 | 按需 | 2–4 周 |
| 6 | 部署流水线 + 生产配置 | 高 | 1–2 周 |
| 7 | 监控、Beta、反馈迭代 | 持续 | - |

---

## 六、参考文档

- **测试与 CI**：`web/tests/README.md`、`_bmad-output/test-generation-summary-2026-01-28--13.md`、`.github/workflows/ci.yml`
- **代码审查**：`_bmad-output/code-review-summary-2026-01-28--22.md`
- **进度与 Epics**：`_bmad-output/sprint-status.yaml`、`_bmad-output/planning-artifacts/epics-2026-01-26--5.md`

---

**状态**：计划已梳理，可按阶段执行。  
**下次更新**：完成阶段一主要事项或优先级变更时更新本文。
